<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HTTP API :: Connect Docs</title>
    <link rel="shortcut icon" type="image/png" href="images/favicon.png"/>
    <script src="//use.typekit.net/jyl8gjp.js?t=1438654489102"></script>
    <script>try{Typekit.load();}catch(e){}</script>
    <link rel="stylesheet" href="styles/all.min.css"/>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body data-spy="scroll" data-target="#nav-wrapper">
    <header>
      <nav class="header-nav navbar navbar-inverse" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand navbar-brand active" href="./">
              <div class="docs-logo-small"></div>
            </a>
          </div>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a class="return" href="https://app.getconnect.io"><i class="ion-arrow-return-left"></i> Return to portal</a>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    
    <div class="white-background-panel">
<div class="container">
  <div class="row">
    <div class="col-sm-3">
      <nav data-spy="affix" id="nav-wrapper" class="hidden-xs" data-offset-top="60" data-offset-bottom="400">
        <ul class="nav switcher">
          <li class="dropdown active">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">HTTP API<span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li>
                  <a href="js.html">JavaScript</a>
                </li>
                <li>
                  <a href="http.html">HTTP API</a>
                </li>
                <li>
                  <a href="ios.html">iOS</a>
                </li>
                <li>
                  <a href="ruby.html">Ruby</a>
                </li>
                <li>
                  <a href="php.html">PHP</a>
                </li>
                <li>
                  <a href="net.html">.NET</a>
                </li>
                <li>
                  <a href="java.html">Java</a>
                </li>
                <li>
                  <a href="android.html">Android</a>
                </li>
            </ul>
          </li>
        </ul>
        
        <ul class="nav left-nav bs-docs-sidenav">
              <li>
                <a href="#getting-started">Getting Started</a>
                
              </li>    
              <li>
                <a href="#authentication">Authentication</a>
                
              </li>    
              <li>
                <a href="#pushing-events">Pushing events</a>
                
                  <ul class="nav">
                      <li>
                        <a href="#single-event">Single event</a>
                      </li>    
                      <li>
                        <a href="#batches-of-events">Batches of events</a>
                      </li>    
                      <li>
                        <a href="#bulk-importing-events">Bulk importing events</a>
                      </li>    
                      <li>
                        <a href="#restrictions-on-pushing">Restrictions on pushing</a>
                      </li>    
                      <li>
                        <a href="#reliability-of-events">Reliability of events</a>
                      </li>    
                      <li>
                        <a href="#timestamps">Timestamps</a>
                      </li>    
                  </ul>
              </li>    
              <li>
                <a href="#querying-events">Querying events</a>
                
                  <ul class="nav">
                      <li>
                        <a href="#metadata">Metadata</a>
                      </li>    
                      <li>
                        <a href="#aggregations">Aggregations</a>
                      </li>    
                      <li>
                        <a href="#filters">Filters</a>
                      </li>    
                      <li>
                        <a href="#timeframes">Timeframes</a>
                      </li>    
                      <li>
                        <a href="#group-by">Group by</a>
                      </li>    
                      <li>
                        <a href="#time-intervals">Time intervals</a>
                      </li>    
                      <li>
                        <a href="#timezones">Timezones</a>
                      </li>    
                  </ul>
              </li>    
              <li>
                <a href="#projects-and-keys">Projects and keys</a>
                
              </li>    
              <li>
                <a href="#modeling-your-events">Modeling your events</a>
                
                  <ul class="nav">
                      <li>
                        <a href="#what-is-an-event-">What is an event?</a>
                      </li>    
                      <li>
                        <a href="#collections">Collections</a>
                      </li>    
                      <li>
                        <a href="#structuring-your-events">Structuring your events</a>
                      </li>    
                      <li>
                        <a href="#restrictions">Restrictions</a>
                      </li>    
                  </ul>
              </li>    
          </ul>
        </nav>
    </div>
    <div class="col-sm-9">
      <h1 id="getting-started">Getting Started</h1>
<p>The following guide will help you to get started using Connect.  Once you have your <a href="#projects-and-keys">project ID and API key</a> and
you have decided how to <a href="#modeling-your-events">model your events</a>, you can start <a href="#pushing-events">pushing events</a> and <a href="#querying">executing queries</a>.</p>
<h1 id="authentication">Authentication</h1>
<p>To <a href="#pushing-events">push events</a> or <a href="#querying-events">execute queries</a>, you must supply the following headers
with the request for authentication:</p>
<ul>
<li><strong>X-Project-Id</strong> - the ID of the project to push to or query.</li>
<li><strong>X-Api-Key</strong> - the push or query API key for the project.</li>
</ul>
<p>Read more about <a href="#projects-and-keys">projects and API keys here</a>. </p>
<h1 id="pushing-events">Pushing events</h1>
<p>Pushing events via HTTP is simple.  Once you have your <a href="#projects-and-keys">project ID and push API key</a>, simply POST the JSON event to your
collection endpoint and your events are available for <a href="#querying">querying</a> immediately.</p>
<h2 id="single-event">Single event</h2>
<blockquote>
<p><strong>POST</strong> <a href="https://api.getconnect.io/events/:collection">https://api.getconnect.io/events/:collection</a></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>collection</td>
<td>collection to which to push the event</td>
</tr>
</tbody>
</table>
</blockquote>
<p>To push a single event, POST it to your collection endpoint.</p>
<p>For example, to push an event to <code>test-collection</code>:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample1" role="tab" data-toggle="tab" data-lang="bash">cURL</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample1"><pre><code class="lang-bash">curl -X POST \
  -H &quot;X-Project-Id: YOUR_PROJECT_ID&quot; \
  -H &quot;X-API-Key: YOUR_API_KEY&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &apos;{ &quot;customer&quot;: { &quot;firstName&quot;: &quot;Tom&quot;, &quot;lastName&quot;: &quot;Smith&quot; }, &quot;product&quot;: &quot;12 red roses&quot;, &quot;purchasePrice&quot;: 34.95 }&apos; \
  https://api.getconnect.io/events/test-collection
</code></pre></div></div></div>
<h3 id="responses">Responses</h3>
<p><strong>200 OK</strong></p>
<p>The event has been successfully recorded.</p>
<p><strong>422 Unprocessable Entity</strong></p>
<p>One or more errors have occurred with the event data sent.</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample2" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample2"><pre><code class="lang-json">{
    &quot;errors&quot;: [
        { &quot;field&quot;: &quot;fieldName&quot;, &quot;description&quot;: &quot;There was an error with this field.&quot; }
    ]
}
</code></pre></div></div></div>
<p><strong>500 Internal server Error</strong></p>
<p>A server error occurred with the Connect API.</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample3" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample3"><pre><code class="lang-json">{
    &quot;errorMessage&quot;: &quot;An error occurred while processing your request&quot;
}
</code></pre></div></div></div>
<p><strong>409 Conflict</strong></p>
<p>An event with the same <code>id</code> property has already been inserted into this collection.</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample4" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample4"><pre><code class="lang-json">{
    &quot;errorMessage&quot;: &quot;An event with the same &apos;id&apos; has already been inserted.&quot;
}
</code></pre></div></div></div>
<p><strong>400 Bad Request</strong></p>
<p>The event data supplied is not valid.</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample5" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample5"><pre><code class="lang-json">{
    &quot;errorMessage&quot;: &quot;Property names starting with tp_ are reserved and cannot be set.&quot;
}
</code></pre></div></div></div>
<h2 id="batches-of-events">Batches of events</h2>
<blockquote>
<p><strong>POST</strong> <a href="https://api.getconnect.io/events">https://api.getconnect.io/events</a></p>
</blockquote>
<p>Instead of pushing events one by one, you can push events in batches. This is beneficial when you have a number of events to push in a single
request or if you wish to push to multiple collections in a single request.</p>
<blockquote>
<p>For large batches (over 5,000 events), you must upload the events to S3 and provide a URL to the batch.
See <a href="#bulk-importing-events">bulk importing events</a> for more information.</p>
</blockquote>
<p>To push event batches, you must POST a batch containing an object of collections to event batches. For example:</p>
<div class="code-samples"><ul class="nav"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown">cURL<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#code-sample6" role="tab" data-toggle="tab" data-lang="bash">cURL</a></li><li><a href="#code-sample7" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample6"><pre><code class="lang-bash">curl -X POST \
  -H &quot;X-Project-Id: YOUR_PROJECT_ID&quot; \
  -H &quot;X-API-Key: YOUR_API_KEY&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &apos;{
    &quot;purchases&quot;: [
        {
            &quot;customer&quot;: {
                &quot;firstName&quot;: &quot;Tom&quot;,
                &quot;lastName&quot;: &quot;Smith&quot;
            },
            &quot;id&quot;: &quot;1849506679&quot;,
            &quot;product&quot;: &quot;12 red roses&quot;,
            &quot;purchasePrice&quot;: 34.95
        },
        {
            &quot;customer&quot;: {
                &quot;firstName&quot;: &quot;Jane&quot;,
                &quot;lastName&quot;: &quot;Doe&quot;
            },
            &quot;id&quot;: &quot;123456&quot;,
            &quot;product&quot;: &quot;1 daisy&quot;,
            &quot;purchasePrice&quot;: 8.95
        }
    ],
    &quot;refunds&quot;: [
        {
            &quot;customer&quot;: {
                &quot;firstName&quot;: &quot;Tom&quot;,
                &quot;lastName&quot;: &quot;Smith&quot;
            },
            &quot;id&quot;: &quot;REF-1234&quot;,
            &quot;product&quot;: &quot;12 red roses&quot;,
            &quot;purchasePrice&quot;: -34.95
        }
    ]
}&apos; \
  https://api.getconnect.io/events
</code></pre></div><div class="tab-pane" id="code-sample7"><pre><code class="lang-json">{
    &quot;purchases&quot;: [
        {
            &quot;customer&quot;: {
                &quot;firstName&quot;: &quot;Tom&quot;,
                &quot;lastName&quot;: &quot;Smith&quot;
            },
            &quot;id&quot;: &quot;1849506679&quot;,
            &quot;product&quot;: &quot;12 red roses&quot;,
            &quot;purchasePrice&quot;: 34.95
        },
        {
            &quot;customer&quot;: {
                &quot;firstName&quot;: &quot;Jane&quot;,
                &quot;lastName&quot;: &quot;Doe&quot;
            },
            &quot;id&quot;: &quot;123456&quot;,
            &quot;product&quot;: &quot;1 daisy&quot;,
            &quot;purchasePrice&quot;: 8.95
        }
    ],
    &quot;refunds&quot;: [
        {
            &quot;customer&quot;: {
                &quot;firstName&quot;: &quot;Tom&quot;,
                &quot;lastName&quot;: &quot;Smith&quot;
            },
            &quot;id&quot;: &quot;REF-1234&quot;,
            &quot;product&quot;: &quot;12 red roses&quot;,
            &quot;purchasePrice&quot;: -34.95
        }
    ]
}
</code></pre></div></div></div>

<p>The above examples inserts events into two separate collections (purchases and refunds) in a single request.</p>
<p>The <a href="#restrictions-on-pushing">restrictions</a> on events in the batches are the same as those for pushing a single event.</p>
<p>Batches will always return a successful response unless the overall batch document is poorly formatted or the batch exceeds the limit (5,000 events).
The response will contain an array of result objects for each collection, with each array containing the result of each event, in order, that was pushed.</p>
<p>Each result object indicates a boolean of <code>success</code>, a boolean of <code>duplicate</code> (indicate a duplicate event based on the <code>id</code> property) and a <code>message</code>
describing the reason for failure, if applicable.</p>
<p>A possible response to the above example could be:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample8" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample8"><pre><code class="lang-json">{
    &quot;purchases&quot;: [
        {
            &quot;success&quot;: true
        },
        {
            &quot;success&quot;: false,
            &quot;duplicate&quot;: true,
            &quot;message&quot;: &quot;An event with the same id has already been inserted.&quot;
        }
    ],
    &quot;refunds&quot;: [
        {
            &quot;success&quot;: true
        }
    ]
}
</code></pre></div></div></div>
<h2 id="bulk-importing-events">Bulk importing events</h2>
<blockquote>
<p><strong>POST</strong> <a href="https://api.getconnect.io/event-import">https://api.getconnect.io/event-import</a></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>collection</td>
<td>collection to which to import the events</td>
</tr>
<tr>
<td>s3Path</td>
<td>path to the S3 file containing the events to import</td>
</tr>
<tr>
<td>s3AccessKeyId</td>
<td>key to access the S3 file</td>
</tr>
<tr>
<td>s3SecretAccessKey</td>
<td>secret key to access the S3 file</td>
</tr>
</tbody>
</table>
</blockquote>
<p>To import a large number of events (usually historical), you must use the event import API and provide a file accessible via S3.</p>
<blockquote>
<p>If you are importing a small number of events (fewer than 5,000), you can use <a href="#batches-of-events">event batches</a> to push the events in the request body.
You&apos;re still welcome to use event imports if you prefer, though!</p>
</blockquote>
<p>The import requires the name of the collection in which to import the events and the S3 details to retrieve the file.</p>
<p>Only JSON formatted files are supported and the format must be a single event per line (not a JSON array). For example, the following is a valid file to import:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample9" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample9"><pre><code class="lang-json">{ &quot;product&quot;: &quot;12 red roses&quot;, &quot;quantity&quot;: 5, &quot;price&quot;: 25.00 }
{ &quot;product&quot;: &quot;White bouquet&quot;, &quot;quantity&quot;: 2, &quot;price&quot;: 48.40 }
</code></pre></div></div></div>
<p>The entire batch will be rejected if the format does not align with this.</p>
<p>For example:</p>
<div class="code-samples"><ul class="nav"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown">cURL<span class="caret"></span></a><ul class="dropdown-menu"><li><a href="#code-sample10" role="tab" data-toggle="tab" data-lang="bash">cURL</a></li><li><a href="#code-sample11" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample10"><pre><code class="lang-bash">curl -X POST \
  -H &quot;X-Project-Id: YOUR_PROJECT_ID&quot; \
  -H &quot;X-API-Key: YOUR_API_KEY&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &apos;{
    &quot;collection&quot;: &quot;purchases&quot;,
    &quot;s3Path&quot;: &quot;s3://mybucket/purchases.json&quot;,
    &quot;s3AccessKeyId&quot;: &quot;YOUR_ACCESS_KEY_ID&quot;,
    &quot;s3SecretAccessKey&quot;: &quot;YOUR_SECRET_ACCESS_KEY&quot;
}&apos; \
  https://api.getconnect.io/event-import
</code></pre></div><div class="tab-pane" id="code-sample11"><pre><code class="lang-json">{
    &quot;collection&quot;: &quot;purchases&quot;,
    &quot;s3Path&quot;: &quot;s3://mybucket/purchases.json&quot;,
    &quot;s3AccessKeyId&quot;: &quot;YOUR_ACCESS_KEY_ID&quot;,
    &quot;s3SecretAccessKey&quot;: &quot;YOUR_SECRET_ACCESS_KEY&quot;
}
</code></pre></div></div></div>

<p>A successful batch import operation results in a <strong>201 Created</strong> response and specifies a URI in the Location header of the response where you can monitor the
status of the batch import.</p>
<h3 id="monitoring-the-import">Monitoring the import</h3>
<blockquote>
<p><strong>GET</strong> <a href="https://api.getconnect.io/event-import/:id">https://api.getconnect.io/event-import/:id</a></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>ID of the event import (returned from the import endpoint on creation in the <code>Location</code> header)</td>
</tr>
</tbody>
</table>
</blockquote>
<p>Once you have started an import of events, you can monitor the import with the URI provided in the Location header of the import API.</p>
<p>This allows you to check the status, progress and speed of the import, as well as any errors that have occurred during the import process.</p>
<p>An example response would be:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample12" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample12"><pre><code class="lang-json">{
    &quot;collection&quot;: &quot;purchases&quot;,
    &quot;status&quot;: &quot;running&quot;,
    &quot;created&quot;: &quot;2015-04-01T00:32:45Z&quot;,
    &quot;started&quot;: &quot;2015-04-01T00:33:03Z&quot;,
    &quot;finished&quot;: null,
    &quot;importedEvents&quot;: 5130985,
    &quot;duplicateEvents&quot;: 0,
    &quot;percentComplete&quot;: 42.43,
    &quot;insertRate&quot;: &quot;15096/s&quot;,
    &quot;error&quot;: null,
    &quot;eventErrors&quot;: [
        { &quot;index&quot;: 9951, &quot;error&quot;: &quot;The JSON specified was not valid.&quot; },
        { &quot;index&quot;: 45930, &quot;error&quot;: &quot;The JSON specified was not valid.&quot; }
    ]
}
</code></pre></div></div></div>
<p>An import can be in one of the following statuses:</p>
<ul>
<li><strong>Pending</strong> - the import is yet to start</li>
<li><strong>Running</strong> - the import is currently running</li>
<li><strong>Complete</strong> - the import completed successfully</li>
<li><strong>Failed</strong> - the import failed (the error will contain the reason)</li>
</ul>
<p>The <code>eventErrors</code> property in the response refers to an array of errors, with the index property of each error referring to the index (or line number) in the import file.</p>
<h2 id="restrictions-on-pushing">Restrictions on pushing</h2>
<p>There are a number of restrictions on the properties you can use in your events and the
limitations on querying which influences how you should structure your events.</p>
<p>Refer to <a href="#restrictions">restrictions</a> in the <a href="#modeling-your-events">modeling your events</a> section.</p>
<h2 id="reliability-of-events">Reliability of events</h2>
<p>When posting an event to Connect, we guarantee the storage of the event if a successful (200) response is returned. This means you can safely flag the event as recorded.</p>
<p>To guarantee event delivery, it is recommended to queue the events for sending to Connect and only remove them from the queue once a successful response has been received.</p>
<p>Events also allow a custom ID to be sent in the event document which will prevent duplicates (i.e. guarantees idempotence even if the event is delivered multiple times). For example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample13" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample13"><pre><code class="lang-json">{
    &quot;customer&quot;: {
        &quot;firstName&quot;: &quot;Tom&quot;,
        &quot;lastName&quot;: &quot;Smith&quot;
    },
    &quot;id&quot;: &quot;1849506679&quot;,
    &quot;product&quot;: &quot;12 red roses&quot;,
    &quot;purchasePrice&quot;: 34.95
}
</code></pre></div></div></div>
<h2 id="timestamps">Timestamps</h2>
<p>All events have a single <code>timestamp</code> property which records when the event being pushed occurred.  Events cannot
have more than one date/time property.  If you feel you need more than one date/time property, you probably need
to reconsider how you&apos;re <a href="#modeling-your-events">modeling your events</a>.</p>
<blockquote>
<p><strong>Querying</strong></p>
<p>You can only run time interval queries or timeframe filters on the <code>timestamp</code> property.  No other date/time property
in an event is supported for querying.</p>
</blockquote>
<p>By default, if no <code>timestamp</code> property is sent with the event, Connect will use the current date and time as
the timestamp of the event.</p>
<p>The timestamp, however, can be overridden to, for example, accommodate historical events or maintain accuracy
of event times when events are queued.</p>
<p>The timestamp must be supplied as an ISO-8601 formatted date.  The date must be in UTC (you cannot specify a timezone offset).
For example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample14" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample14"><pre><code class="lang-json">{
    &quot;customer&quot;: {
        &quot;firstName&quot;: &quot;Tom&quot;,
        &quot;lastName&quot;: &quot;Smith&quot;
    },
    &quot;timestamp&quot;: &quot;2015-02-05T14:55:56.587Z&quot;,
    &quot;product&quot;: &quot;12 red roses&quot;,
    &quot;purchasePrice&quot;: 34.95
}
</code></pre></div></div></div>
<blockquote>
<p><strong>Timezones</strong></p>
<p>Timestamps are always recorded in UTC.  If you supply a timestamp in a timezone other than UTC, it will
be converted to UTC.  When you query your events, you can specify a timezone so things like time intervals
will be returned in local time.</p>
</blockquote>
<h1 id="querying-events">Querying events</h1>
<blockquote>
<p><strong>GET</strong> <a href="https://api.getconnect.io/event/:collection?query=">https://api.getconnect.io/event/:collection?query=</a></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>collection</td>
<td>collection to query</td>
</tr>
<tr>
<td>query (query string parameter)</td>
<td>query to run</td>
</tr>
</tbody>
</table>
</blockquote>
<p>Querying events in Connect is easy - you construct a query document and perform a GET request with the URL-encoded JSON in the <code>query</code> parameter of the query string.</p>
<p>For example, to get the sum of the <code>price</code> property in a collection called <code>purchases</code>, you would build the following query:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample15" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample15"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    }
}
</code></pre></div></div></div>
<p>To execute the query, you would run:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample16" role="tab" data-toggle="tab" data-lang="bash">cURL</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample16"><pre><code class="lang-bash">curl -H &quot;X-Project-Id: YOUR_PROJECT_ID&quot; \
     -H &quot;X-API-Key: YOUR_API_KEY&quot; \
     https://api.getconnect.io/events/purchases?query={select:{totalPrice:{sum:&apos;price&apos;}}}
</code></pre></div></div></div>
<h2 id="metadata">Metadata</h2>
<p>The query results return metadata on the executed query.  This includes any <a href="#group-by">groups</a> used, the <a href="#time-intervals">time interval</a>, if specified,
and the <a href="#timezones">timezone</a>, if specified, for the query.</p>
<p>For example, if you grouped by <code>product</code>, with a <strong>daily</strong> time interval and a timezone of <strong>Australia/Brisbane</strong>, the metadata would look like:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample17" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample17"><pre><code class="lang-json">{
    &quot;groups&quot;: [&quot;product&quot;],
    &quot;interval&quot;: &quot;daily&quot;,
    &quot;timezone&quot;: &quot;Australia/Brisbane&quot;
}
</code></pre></div></div></div>
<p>Metadata is used by our Visualization SDK to discover the shape of your query so that we can easily display the results.  If you&apos;re doing your own visualization,
you can take advantage of the metadata as hints on how to render the results.</p>
<h2 id="aggregations">Aggregations</h2>
<p>You can perform various aggregations over events you have pushed.  Simply specify in the query&apos;s select which
fields you wish to aggregate and which aggregation you wish to use.  You also must specify an &quot;alias&quot; for the
result set that is returned.</p>
<p>For example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample18" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample18"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;itemsSold&quot;: &quot;count&quot;,
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; },
        &quot;averagePrice&quot;: { &quot;avg&quot;: &quot;price&quot; },
        &quot;minPrice&quot;: { &quot;min&quot;: &quot;price&quot; },
        &quot;maxPrice&quot;: { &quot;max&quot;: &quot;price&quot; }
    }
}
</code></pre></div></div></div>


<p>This would return a result like:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample21" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample21"><pre><code class="lang-json">{
    &quot;metadata&quot;: {
        &quot;groups&quot;: [],
        &quot;interval&quot;: null,
        &quot;timezone&quot;: null
    },
    {
        &quot;itemsSold&quot;: 25,
        &quot;totalPrice&quot;: 5493.25,
        &quot;averagePrice&quot;: 219.73,
        &quot;minPrice&quot;: 5.49,
        &quot;maxPrice&quot;: 589.20
    }
}
</code></pre></div></div></div>

<p>The following aggregations are supported:</p>
<ul>
<li>count</li>
<li>sum</li>
<li>avg</li>
<li>min</li>
<li>max</li>
</ul>
<h3 id="limitations">Limitations</h3>
<ul>
<li>Aggregations only work on numeric fields.  If you try to aggregate a string field, you will receive a null result.
If you try to aggregate a field with multiple types (e.g. some strings, some numbers), only the numeric values will be
added - the rest are ignored.</li>
</ul>
<h2 id="filters">Filters</h2>
<p>You can filter the events you wish to include in your queries by specifying one or more filters.  For example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample23" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample23"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;filter&quot;: {
        &quot;product&quot;: &quot;12 red roses&quot;
    }
}
</code></pre></div></div></div>


<p>The above will filter the query results for only those events that have a <code>product</code> property equalling &quot;12 red roses&quot;.
The above is also shorthand for the <strong>eq</strong> operator. To illustrate this, the following is identical to the above:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample26" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample26"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;filter&quot;: {
        &quot;product&quot;: { &quot;eq&quot;: &quot;12 red roses&quot; }
    }
}
</code></pre></div></div></div>


<p>The following match operators are currently supported:</p>
<ul>
<li>eq (equal to)</li>
<li>neq (not equal to)</li>
<li>gt (greater than)</li>
<li>gte (greater than or equal to)</li>
<li>lt (less than)</li>
<li>lte (less than or equal to)</li>
<li><a href="#exists-filter">exists (whether or not a property exists)</a></li>
<li>startsWith (starts with - string values only)</li>
<li>endsWidth (ends with - string values only)</li>
<li>contains (contains - string values only)</li>
<li><a href="#in-filter">in (property is one of a list of values)</a> </li>
</ul>
<h3 id="exists-filter">Exists filter</h3>
<p>The exists filter will filter the query results for only events that either have or don&apos;t have the specified property
and where the specified property is or isn&apos;t null respectively.  You supply a boolean value with the exists operator
to specify whether to include or exclude the events.</p>
<blockquote>
<p><strong>Missing properties vs null values</strong></p>
<p>We treat missing properties and properties with a null value the same for the purpose of the exists filter.  While we
plan to change this behavior in the future, you should consider setting a default value as opposed to a null value on
properties if you wish to make a distinction.</p>
</blockquote>
<p>For example, the following will filter for events that have a property called <code>gender</code>:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample29" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample29"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;filter&quot;: {
        &quot;gender&quot;: { &quot;exists&quot;: true }
    }
}
</code></pre></div></div></div>


<p>Whereas the following will filter for events that <em>do not</em> have a property called <code>gender</code>:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample32" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample32"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;filter&quot;: {
        &quot;gender&quot;: { &quot;exists&quot;: false }
    }
}
</code></pre></div></div></div>


<h3 id="in-filter">In filter</h3>
<p>The in filter allows you to specify a list of values for which a field should match.</p>
<p>For example, the following will filter for events that have a <code>category</code> of either &quot;Bikes&quot;, &quot;Books&quot; or &quot;Magazines&quot;:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample35" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample35"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;filter&quot;: {
        &quot;category&quot;: { &quot;in&quot;: [&quot;Bikes&quot;, &quot;Books&quot;, &quot;Magazines&quot;] }
    }
}
</code></pre></div></div></div>

<p><strong>Note:</strong> All values in the list must be of the same type (i.e. string, numeric or boolean).  Mixed types are currently not supported.</p>
<h3 id="combining-filter-expressions">Combining filter expressions</h3>
<p>You can also combine filter expressions to filter multiple values on the same property.</p>
<p>For example, the following will filter for events with a <code>price</code> property greater than 5 but less than 10:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample37" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample37"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;filter&quot;: {
        &quot;price&quot;: { &quot;gt&quot;: 5, &quot;lt&quot;: 10 }
    }
}
</code></pre></div></div></div>


<h3 id="-or-filters">&quot;Or&quot; filters</h3>
<p>Currently, &quot;or&quot; filters are not supported.</p>
<h2 id="timeframes">Timeframes</h2>
<p>You can restrict query results by specifying the <strong>timeframe</strong> for the query which will filter for events only within that specific timeframe.</p>
<blockquote>
<p>If no timeframe is specified, events will not be filtered by time; the query will match events from all time.</p>
</blockquote>
<p>For example, the following query filters for events only for this month:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample40" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample40"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timeframe&quot;: &quot;this_month&quot;
}
</code></pre></div></div></div>


<p>There are two types of timeframes:</p>
<ul>
<li><strong>Relative timeframes</strong> - a timeframe relative to the current date and time.</li>
<li><strong>Absolute timeframes</strong> - a timeframe between two specific dates and times.</li>
</ul>
<h3 id="relative-timeframes">Relative timeframes</h3>
<p>Relative timeframes can be specified as either a string or a complex type containing exact numbers of &quot;periods&quot; to filter.</p>
<blockquote>
<p><strong>Timezones</strong></p>
<p>By default, all relative timeframes are <strong>UTC</strong> by default. See the <a href="#timezones">timezone section</a> to specify your own timezone.</p>
</blockquote>
<p>The following are supported string timeframes:</p>
<ul>
<li>this_minute</li>
<li>last_minute</li>
<li>this_hour</li>
<li>last_hour</li>
<li>today</li>
<li>yesterday</li>
<li>this_week</li>
<li>last_week</li>
<li>this_month</li>
<li>last_month</li>
<li>this_quarter</li>
<li>last_quarter</li>
<li>this_year</li>
<li>last_year</li>
</ul>
<p>You can also specify exactly how many current/previous periods you wish to include in the query results.</p>
<p>For example, if you want to filter by the <strong>today and the last 2 days</strong>:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample43" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample43"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timeframe&quot;: { &quot;current&quot;: { &quot;days&quot;: 3 } }
}
</code></pre></div></div></div>

<p>Or, to filter by the <strong>last 2 months, excluding the current month</strong>:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample45" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample45"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timeframe&quot;: { &quot;previous&quot;: { &quot;months&quot;: 2 } }
}
</code></pre></div></div></div>

<p>The following periods are supported for complex, relative timeframes:</p>
<ul>
<li>minutes</li>
<li>hours</li>
<li>days</li>
<li>weeks</li>
<li>months</li>
<li>quarters</li>
<li>years</li>
</ul>
<blockquote>
<p><strong>Weeks</strong></p>
<p>Our weeks start on a Sunday and finish on a Saturday.  In the future, we plan to support specifying on which
day of the week you&apos;d like to start your weeks.</p>
</blockquote>
<h3 id="absolute-timeframes">Absolute timeframes</h3>
<p>You can specify an absolute timeframe by constructing an object with the <strong>start</strong> and <strong>end</strong> properties set to
the desired start and end times in ISO-8601 format.</p>
<p>For example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample47" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample47"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { sum: &quot;price&quot; }
    },
    &quot;timeframe&quot;: { &quot;start&quot;: &quot;2015-02-01T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-25T00:00:00Z&quot; }
}
</code></pre></div></div></div>
<blockquote>
<p>You can&apos;t specify a timezone when using absolute timeframes as the timezone information comes from the ISO-8601
dates specified.  An error will occur if you try to do this.</p>
</blockquote>
<h2 id="group-by">Group by</h2>
<p>You can group the query results by one or more properties from your events.</p>
<blockquote>
<p><strong>Missing properties vs null values</strong></p>
<p>We treat missing properties and properties with a null value the same for the purpose of grouping.
This means that all events with a null value for a property or missing that property altogether will
be grouped into the &quot;null&quot; value for that query.  While we plan to change this in the future, you
should consider setting a default value as opposed to a null value on properties if you wish to make
a distinction.</p>
</blockquote>
<p>For example, to query total sales by country:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample48" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample48"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;groupBy&quot;: &quot;country&quot;
}
</code></pre></div></div></div>


<p>This would return a result like:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample51" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample51"><pre><code class="lang-json">{
    &quot;metadata&quot;: {
        &quot;groups&quot;: [&quot;country&quot;],
        &quot;interval&quot;: null,
        &quot;timezone&quot;: null
    },
    &quot;results&quot;: [{
        &quot;country&quot;: &quot;Australia&quot;,
        &quot;totalPrice&quot;: 1000000
    },
    {
        &quot;country&quot;: &quot;Italy&quot;,
        &quot;totalPrice&quot;: 2500000
    },
    {
        &quot;country&quot;: &quot;United States&quot;,
        &quot;totalPrice&quot;: 10000000
    }]
}
</code></pre></div></div></div>

<h3 id="grouping-by-multiple-properties">Grouping by multiple properties</h3>
<p>You can also group by multiple properties in your events by providing multiple property names.</p>
<p>For example, to query total sales by country and product category:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample53" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample53"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;groupBy&quot;: [&quot;country&quot;, &quot;product.category&quot;]
}
</code></pre></div></div></div>


<p>This would return a result like:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample56" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample56"><pre><code class="lang-json">{
    &quot;metadata&quot;: {
        &quot;groups&quot;: [&quot;country&quot;, &quot;product.category&quot;],
        &quot;interval&quot;: null,
        &quot;timezone&quot;: null
    },
    &quot;results&quot;: [{
        &quot;country&quot;: &quot;Australia&quot;,
        &quot;product.category&quot;: &quot;Bikes&quot;,
        &quot;totalPrice&quot;: 500000
    },
    {
        &quot;country&quot;: &quot;Australia&quot;,
        &quot;product.category&quot;: &quot;Cars&quot;,
        &quot;totalPrice&quot;: 500000
    },
    {
        &quot;country&quot;: &quot;Italy&quot;,
        &quot;product.category&quot;: &quot;Scooters&quot;,
        &quot;totalPrice&quot;: 2500000
    },
    {
        &quot;country&quot;: &quot;United States&quot;,
        &quot;product.category&quot;: &quot;Mobile Phones&quot;,
        &quot;totalPrice&quot;: 8000000
    },
    {
        &quot;country&quot;: &quot;United States&quot;,
        &quot;product.category&quot;: &quot;Laptops&quot;,
        &quot;totalPrice&quot;: 2000000
    }] 
}
</code></pre></div></div></div>

<h2 id="time-intervals">Time intervals</h2>
<p>Time intervals allow you to group results by a time period, so that you could analyze your events over time.</p>
<p>For example, to query daily total sales this month:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample58" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample58"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timeframe&quot;: &quot;this_month&quot;,
    &quot;interval&quot;: &quot;daily&quot;
}
</code></pre></div></div></div>


<p>This would return a result like:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample61" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample61"><pre><code class="lang-json">{
    &quot;metadata&quot;: {
        &quot;groups&quot;: [],
        &quot;interval&quot;: &quot;daily&quot;,
        &quot;timezone&quot;: null
    },
    &quot;results&quot;: [{
        &quot;interval&quot;: { &quot;start&quot;: &quot;2015-02-01T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-02T00:00:00Z&quot; },
        &quot;results&quot;: [{
            &quot;totalPrice&quot;: 500000
        }]
    },
    {
        &quot;interval&quot;: { &quot;start&quot;: &quot;2015-02-02T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-03T00:00:00Z&quot; },
        &quot;results&quot;: [{
            &quot;totalPrice&quot;: 150000
        }]
    },
    {
        &quot;interval&quot;: { &quot;start&quot;: &quot;2015-02-03T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-04T00:00:00Z&quot; },
        &quot;results&quot;: [{
            &quot;totalPrice&quot;: 25000
        }]
    }]
}
</code></pre></div></div></div>

<p>The following time intervals are supported:</p>
<ul>
<li>minutely</li>
<li>hourly</li>
<li>daily</li>
<li>weekly</li>
<li>monthly</li>
<li>quarterly</li>
<li>yearly</li>
</ul>
<h3 id="time-interval-with-group-by">Time interval with group by</h3>
<p>You can also combine a time interval with a group by in your query.</p>
<p>For example, to query daily total sales this month by country:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample63" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample63"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timeframe&quot;: &quot;this_month&quot;,
    &quot;interval&quot;: &quot;daily&quot;,
    &quot;groupBy&quot;: &quot;country&quot;
}
</code></pre></div></div></div>


<p>This would return a result like:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample66" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample66"><pre><code class="lang-json">{
    &quot;metadata&quot;: {
        &quot;groups&quot;: [&quot;country&quot;],
        &quot;interval&quot;: &quot;daily&quot;,
        &quot;timezone&quot;: null
    },
    &quot;results&quot;: [{
        &quot;interval&quot;: { &quot;start&quot;: &quot;2015-02-01T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-02T00:00:00Z&quot; },
        &quot;results&quot;: [
            {
                &quot;country&quot;: &quot;Australia&quot;,
                &quot;totalPrice&quot;: 100000
            },
            {
                &quot;country&quot;: &quot;Italy&quot;,
                &quot;totalPrice&quot;: 100000
            },
            {
                &quot;country&quot;: &quot;United States&quot;,
                &quot;totalPrice&quot;: 300000
            }
        ]
    },
    {
        &quot;interval&quot;: { &quot;start&quot;: &quot;2015-02-02T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-03T00:00:00Z&quot; },
        &quot;results&quot;: [
            {
                &quot;country&quot;: &quot;Australia&quot;,
                &quot;totalPrice&quot;: 25000
            },
            {
                &quot;country&quot;: &quot;Italy&quot;,
                &quot;totalPrice&quot;: 25000
            },
            {
                &quot;country&quot;: &quot;United States&quot;,
                &quot;totalPrice&quot;: 100000
            }
        ]
    },
    {
        &quot;interval&quot;: { &quot;start&quot;: &quot;2015-02-03T00:00:00Z&quot;, &quot;end&quot;: &quot;2015-02-04T00:00:00Z&quot; },
        &quot;results&quot;: [
            {
                &quot;country&quot;: &quot;Australia&quot;,
                &quot;totalPrice&quot;: 5000
            },
            {
                &quot;country&quot;: &quot;Italy&quot;,
                &quot;totalPrice&quot;: 5000
            },
            {
                &quot;country&quot;: &quot;United States&quot;,
                &quot;totalPrice&quot;: 15000
            }
        ]
    }]
}
</code></pre></div></div></div>

<h2 id="timezones">Timezones</h2>
<p>By default, Connect uses <strong>UTC</strong> as the timezone for queries with relative timeframes or time intervals.
You can override this to be the timezone of your choice by specifying the <strong>timezone</strong> in your query.</p>
<blockquote>
<p>You can only specify a timezone when you have specified a <a href="#time-intervals">time interval</a> or a
<a href="#relative-timeframes">relative timeframe</a>.  If you try to specify a timezone without one of these
set, an error will be returned.</p>
</blockquote>
<p>You can specify a numeric (decimal) value for an hours offset of UTC, for example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample68" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample68"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timezone&quot;: 10
}
</code></pre></div></div></div>


<p>You can also specify a string which contains an <a href="http://www.iana.org/time-zones">IANA time zone identifier</a>, for example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample71" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample71"><pre><code class="lang-json">{
    &quot;select&quot;: {
        &quot;totalPrice&quot;: { &quot;sum&quot;: &quot;price&quot; }
    },
    &quot;timezone&quot;: &quot;Australia/Brisbane&quot;
}
</code></pre></div></div></div>


<h1 id="projects-and-keys">Projects and keys</h1>
<p>Connect allows you to manage multiple projects under a single account so that you can easily segregate
your collections into logical projects.</p>
<p>You could use this to separate analytics for entire projects, or to implement separation between different
environments (e.g. My Project (Prod) and My Project (Dev)).</p>
<p>To start pushing and querying your event data, you will need both a project ID and an API key.  This information
is available to you <a href="http://app.getconnect.io/#/projects">via the portal</a> inside each project under the &quot;Keys&quot; tab:</p>
<p><img src="images/screens/projects-keys.png" alt="Screenshot of project keys in Connect portal"></p>
<p>By default, you can choose from four different types of keys, each with their own specific use:</p>
<ul>
<li><p><code>Push/Query Key</code> - you can use this key to both push events and execute queries.<br>You should only use this key in situations where it is not possible to isolate merely pushing or querying.</p>
</li>
<li><p><code>Push Key</code> - you can only use this key to push events.<br>You should use this key in your apps where you are tracking event data, but do not require querying.</p>
</li>
<li><p><code>Query Key</code> - you can only use this key to execute queries.<br>You should use this key in your reporting interfaces where you do not wish to track events.</p>
</li>
<li><p><code>Master Project Key</code> - you can use this key to execute all types of operations on a project, including
pushing, querying and deleting collections.<br><strong>Keep this key safe</strong> - it is intended for very limited use and definitely should not be included in your main apps.</p>
</li>
</ul>
<p>You must use your project ID and desired key to begin using Connect:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample77" role="tab" data-toggle="tab" data-lang="bash">cURL</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample77"><pre><code class="lang-bash">curl -X POST \
  -H &quot;X-Project-Id: YOUR_PROJECT_ID&quot; \
  -H &quot;X-API-Key: YOUR_API_KEY&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d &apos;{ &quot;customer&quot;: { &quot;firstName&quot;: &quot;Tom&quot;, &quot;lastName&quot;: &quot;Smith&quot; }, &quot;product&quot;: &quot;12 red roses&quot;, &quot;purchasePrice&quot;: 34.95 }&apos; \
  https://api.getconnect.io/events/test-collection
</code></pre></div></div></div>








<h1 id="modeling-your-events">Modeling your events</h1>
<p>When using Connect to analyze and visualize your data, it is important to understand how best to model your events.
The way you structure your events will directly affect your ability to answer questions with your data.  It is therefore
important to consider up-front the kind of questions you anticipate answering.</p>
<h2 id="what-is-an-event-">What is an event?</h2>
<p>An event is an action that occurs at a specific point in <strong>time</strong>. To answer &quot;why did this event occur?&quot;, our event needs
to contain rich details about what the &quot;world&quot; looked like at that point in time.</p>
<p>Put simply, events = action + time + state.</p>
<p>For example, imagine you are writing an exercise activity tracker app.  We want to give users of your app the ability to
analyze their performance over time.  This is an event produced by our hypothetical activity tracker app:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample83" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample83"><pre><code class="lang-json">{
    &quot;type&quot;: &quot;cycling&quot;,
    &quot;timestamp&quot;: &quot;2015-06-23T16:31:56.587Z&quot;,
    &quot;duration&quot;: 67,
    &quot;distance&quot;: 21255,
    &quot;caloriesBurned&quot;: 455,
    &quot;maxHeartRate&quot;: 182,
    &quot;user&quot;: {
        &quot;id&quot;: &quot;638396&quot;,
        &quot;firstName&quot;: &quot;Bruce&quot;,
        &quot;lastName&quot;: &quot;Jones&quot;,
        &quot;age&quot;: 35
    }
}
</code></pre></div></div></div>






<h3 id="action">Action</h3>
<p>What happened? In the above example, the action is <em>an activity was completed</em>.</p>
<p>In most circumstances, we <a href="#collections">group all events of the same action into a single collection</a>.
In this case, we could call our collection <code>activityCompleted</code>, or alternatively, just <code>activity</code>.</p>
<h3 id="time">Time</h3>
<p>When did it happen? In the above example, we specified the start time of the activity as the value of the <strong>timestamp</strong> property.
The top-level <strong>timestamp</strong> property is a special property in Connect.  This is because <em>time</em> is an essential property of event
data - it&apos;s not optional.</p>
<p>When an event is pushed to Connect, the current time is assigned to the timestamp property if no value was provided by you.</p>
<h3 id="state">State</h3>
<p>What do we know about this action?  What do we know about the entities associated with this action?  What do we know about the &quot;world&quot;
at this moment in time?  Every property in our event, besides the timestamp and the name of the collection, serves to answer those
questions.  This is the most important aspect of our event - it&apos;s where all the answers live.</p>
<p>The richer the data you provide in your event, the more questions you can answer for your users, therefore it&apos;s important to enrich
your events with as much information as possible.  In stark contrast to the relational model where you would store this related
information in separate tables and join at query time, in the event model this data is denormalized into each event, so as to know
the state of the &quot;world&quot; at the point in time of the event.</p>
<h2 id="collections">Collections</h2>
<p>It is important when modeling your events to consider how you intend to group those events into collections.  This is a careful balance between events being
broad enough to answer queries for your users, while specific enough to be manageable.</p>
<p>In our <a href="#what-is-an-event-">activity example</a>, the activity contains different properties based on what the type of activity.  Our cycling activity contains properties associated
with the bike that was used, while a kayaking activity may contain properties associated with a kayak that is used.</p>
<p>Because a kayaking event may have different properties to a running event, it might seem logical to put each of them in distinct collections.  However, if we
had distinct <code>cycling</code>, <code>running</code> and  <code>kayaking</code> collections, we would lose the opportunity to query details that are common to all activities.</p>
<p>As a general rule, consider the common action among your events and decide if the specific variants of that action warrant grouping those events together. </p>
<h2 id="structuring-your-events">Structuring your events</h2>
<p>Events have the following core properties:</p>
<ul>
<li>Denormalized</li>
<li>Immutable</li>
<li>Rich/nested</li>
<li>Schemaless</li>
</ul>
<p>It is also important to consider how to group events into collections to enable future queries to be answered.</p>
<h3 id="events-are-denormalized">Events are denormalized</h3>
<p>Consider our example event again, notice the age property of the user:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample90" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample90"><pre><code class="lang-json">{
    &quot;type&quot;: &quot;cycling&quot;,
    ...
    &quot;user&quot;: {
        &quot;id&quot;: &quot;638396&quot;,
        &quot;firstName&quot;: &quot;Bruce&quot;,
        &quot;lastName&quot;: &quot;Jones&quot;,
        &quot;age&quot;: 35
    }
}
</code></pre></div></div></div>






<p>The user&apos;s age is going to be duplicated in every activity he/she completes throughout the year. This may seem inefficient; however,
remember that Connect is about <strong>analyzing</strong>.  This denormalization is a real win for analysis; the key is that event data stores state
over time, rather than merely current state.  This helps us answer questions about <em>why</em> something happened, because we know what the
&quot;world&quot; looked like at that point of time.</p>
<p>For example imagine we wanted to chart the average distance cycled per ride, grouped by the age of the rider at the time of the ride.
We could simply execute the following query:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample99" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample99"><pre><code class="lang-json">{
    &quot;select&quot;: { &quot;averageDistance&quot;: { &quot;avg&quot;: &quot;distance&quot; } },
    &quot;groupBy&quot;: &quot;user.age&quot;
}
</code></pre></div></div></div>


<p>It&apos;s this persistence of state over time that makes event data perfect for analysis.</p>
<h3 id="events-are-immutable">Events are immutable</h3>
<p>By their very nature, events cannot change, as they always record state at the point in time of the event.  This is also the reason to
record as much rich information about the event and &quot;state of the world&quot; as possible.</p>
<p>For example, in our example event above, while Bruce Jones may now be many years older, at the time he completed his bike ride, he was
35 years of age.  By ensuring this event remains immutable, we can correctly analyze bike riding over time by 35-year-olds.</p>
<p>Consider events as recording history - as much as we&apos;d occasionally like to, we can&apos;t change history!</p>
<h3 id="events-are-rich-and-nested">Events are rich and nested</h3>
<p>Events are rich in that they specify very detailed state.  They specify details about the event itself, the entities involved and the state of
the &quot;world&quot; at that point in time. </p>
<p>Consider our example activity event - the top level <strong>type</strong> property describes something about the activity itself (a run, a bike ride, a kayak
etc.).  The user property specifies rich information about the actor who performed the event.  In this case it&apos;s the person who completed the
activity, complete with their name and age.</p>
<p>In reality, though, we may decide to include a few other nested entities in our event, for example:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample100" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample100"><pre><code class="lang-json">{
    &quot;type&quot;: &quot;cycling&quot;,
    ...
    &quot;user&quot;: {
        &quot;id&quot;: &quot;638396&quot;,
        &quot;firstName&quot;: &quot;Bruce&quot;,
        ...
    },
    &quot;bike&quot;: {
        &quot;id&quot;: &quot;231806&quot;,
        &quot;brand&quot;: &quot;Specialized&quot;,
        &quot;model&quot;: &quot;S-Works Venge&quot;
    },
    &quot;weather&quot;: {
        &quot;condition&quot;: &quot;Raining&quot;,
        &quot;temperature&quot;: 21,
        &quot;humidity&quot;: 99,
        &quot;wind&quot;: 17
    }
}
</code></pre></div></div></div>






<p>Note our event now includes details about the bike used and the weather conditions at the time of the activity.  By adding this extra bike state information
to our event, we have opened up extra possibilities for interrogating our data. For example, we can now query the average distance cycled by each model of bike
that was built by &quot;Specialized&quot;:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample109" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample109"><pre><code class="lang-json">{
    &quot;select&quot;: { &quot;averageDistance&quot;: { &quot;avg&quot;: &quot;distance&quot; } },
    &quot;groupBy&quot;: &quot;bike.model&quot;,
    &quot;filter&quot;: { &quot;bike.brand&quot;: &quot;Specialized&quot; }
}
</code></pre></div></div></div>


<p>The weather also provides us with exciting insights - what did the world look like at this point in time?  What was the weather like?  Storing this data
allows us to answer yet more questions.  We can test our hypothesis that &quot;older people are less scared of riding in the rain&quot; by simply charting the
following query:</p>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample112" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample112"><pre><code class="lang-json">{
    &quot;select&quot;: { &quot;averageDistance&quot;: { &quot;avg&quot;: &quot;distance&quot; } },
    &quot;groupBy&quot;: [&quot;user.age&quot;, &quot;weather.condition&quot;]
}
</code></pre></div></div></div>


<p>As you can see, the richer and more denormalized the event, the more interesting answers can be derived when later querying.</p>
<h3 id="events-are-schemaless">Events are schemaless</h3>
<p>Events in Connect should be considered semi-structured - that is, they have an inherent structure, but it is not defined.  This means you can, and should,
push as much detailed information about an event and the state of the &quot;world&quot; as possible.  Moreover, this allows you to improve your schema over time and
add extra information about new events as that information becomes available.</p>
<h2 id="restrictions">Restrictions</h2>
<p>While you can post almost any event structure to Connect, there are a few, by-design restrictions.</p>
<h3 id="property-names">Property names</h3>
<ul>
<li><p>You cannot have any property in the root document beginning with &quot;tp_&quot;. This is because we prefix our
own internal properties with this. Internally, we merge our properties into your events for performance
at query time.</p>
</li>
<li><p>The property &quot;_id&quot; is reserved and cannot be pushed.</p>
</li>
<li><p>The properties &quot;id&quot; and &quot;timestamp&quot; have special purposes. These allow consumers to specify a unique ID
per event and override the event&apos;s timestamp respectively.  You cannot use the &quot;id&quot; property in queries.
Refer to <a href="#reliability-of-events">&quot;reliability of events&quot;</a> and <a href="#timestamps">&quot;timestamps&quot;</a> for information.</p>
</li>
<li><p>The length of property names can&apos;t exceed 255 characters.  If you need property names longer than this, you
probably <a href="#structuring-your-events">need to reconsider the structure of your event!</a></p>
</li>
<li><p>Properties cannot include a dot in their names.  This is because dots are used in querying to access nested
properties.  The following is an example of an invalid event property due to a dot in the name:</p>
</li>
</ul>
<div class="code-samples"><ul class="nav hide"><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown"></a><ul class="dropdown-menu"><li><a href="#code-sample113" role="tab" data-toggle="tab" data-lang="json">JSON</a></li></ul></li></ul><div class="tab-content"><div class="tab-pane active" id="code-sample113"><pre><code class="lang-json">{
    &quot;invalid.property&quot;: &quot;value&quot;
}
</code></pre></div></div></div>






<h3 id="arrays">Arrays</h3>
<p>While you can create events with arrays, it is currently not possible to take advantage of these arrays at
query time.  Therefore, you should avoid using arrays in your events unless you plan to export the raw events.</p>
<h3 id="distinct-count">Distinct count</h3>
<p>Distinct count is currently not supported for querying, therefore you should consider how to structure your
event if your application relies on this.</p>

    </div>
  </div>  
</div>

    </div>
    
    <footer>
      <nav class="footer-nav navbar navbar-inverse" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand hidden-xs navbar-brand active" href="http://getconnect.io">
              <div class="brand-logo-small"></div>
            </a>
          </div>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://app.getconnect.io/#/projects">Projects</a></li>
            <li><a href="https://app.getconnect.io/#/settings">Settings</a></li>
            <li><a href="https://gitter.im/getconnect">Community</a></li>
            <li><a href="http://docs.getconnect.io/">Docs</a></li>
            <li>
              <a href="https://github.com/getconnect">
                <span class="ion ion-social-github"></span>
              </a>
            </li>
            <li>
              <a href="https://twitter.com/getconnect_io">
                <span class="ion ion-social-twitter"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </footer>
    
    <div class="status">
		    <a href="http://status.getconnect.io" target="_blank">
		      <span class="color-dot"></span>
		      <span class="color-description"></span>
		    </a>
		</div>
    
    <script src="https://statuspage-production.s3.amazonaws.com/se-v1.js"></script>
    <script src="scripts/highlight.pack.min.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <script src="scripts/bootstrap.min.js"></script>
    <script src="scripts/svg-injector.min.js"></script>
    <script src="scripts/docs.min.js"></script>

  	<script>
      var svgs = document.querySelectorAll('img.inject-me');
      SVGInjector(svgs);
  		
      var sp = new StatusPage({ pageId: '3ynj22l3r4d8'});
  		sp.getStatus({
  		  success: function(data) {
  		    $('.color-description').text(data.status.description);
  		    $('.color-dot').addClass(data.status.indicator);
  		  }
  		});
      
      $(function() {
  			$('pre code').each(function(i, block) {
  		  	hljs.highlightBlock(block);
  		  });  
  		});
  	</script>
  </body>
</html>