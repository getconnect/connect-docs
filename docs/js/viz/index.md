# Visualizing data

To start visualizing data with our visualizations, you must ensure you have first included the viz library.

If you are [using the CDN](#cdn) or [Bower](#bower), make sure you've referenced the library and CSS file.

For [NPM](#npm), make sure you've installed the `connect-js-viz` package and referenced the library and the CSS
(via Browserify or through other means).

Once this is correctly installed, you can start creating visualizations, for example:

<p data-height="300" data-theme-id="17963" data-slug-hash="WvBGEO" data-default-tab="results" data-user="getconnect" class='codepen'>See the Pen <a href='http://codepen.io/getconnect/pen/WvBGEO/'>Connect Text viz</a> by Connect (<a href='http://codepen.io/getconnect'>@getconnect</a>) on <a href='http://codepen.io'>CodePen</a>.</p>

## Creating visualizations

To create a viz, you must provide:
* a [query](#query) to visualize.
* a [viz type](#viz-type).
* a HTML [container](#container) that the visualization will be appended to.

You may also supply:
* [options](#options) to configure the behavior and appearance of the visualization.

To create a new visualization you call the `visualize(query)` method on either `Connect` itself or an instance of `Connect`.

For example, to [visualize a chart](#chart-visualizations):

```js
    
var query = connect.query('purchases')
    .select({
        totalSales: { sum: 'purchasePrice' }
    })
    .groupBy('product')
    .interval('monthly');

var chart = Connect.visualize(query)
    .as('chart')
    .inside('#chart')
    .draw();

```

By using the [metadata](#metadata) from the result set, visualizations **automatically** map the query results to various elements.
For example, [chart visualizations](#chart-visualizations) will automatically decide how to map [groups](#group-by),
[time series](#time-intervals) and [aggregations](#aggregations) to its axes or series. 

Note. You should also be mindful of the [viz lifecycle](#viz-lifecycle) so you can [refresh](#refreshing-visualizations),
[update](#updating-visualizations) or [destroy](#destroying-visualizations) visualizations as required.

### Query 

When creating a visualization builder with the `visualize(query)` method you can specify either a [query](#querying-events) generated by `connect.query` or a **function** that returns a promise
(of a valid result set).

Specifying a **function** that returns a promise can be useful if you want to
[chain promises and run your own custom calculations](#manipulating-results-client-side) on the result set or combine it
with other services' data.  For example:

```js
var query = connect.query('purchases')
    .select({
        totalSales: { sum: 'purchasePrice' }
    })
    .groupBy('product')
    .interval('monthly');
    
var resultsFactory = function() {
  return query.execute()
    .then(function (results) {
        var newResults = results.clone();
        // modify the new results
        return newResults;
    });
}

var chart = Connect.visualize(resultsFactory)
    .as('chart')
    .inside('#chart')
    .with({
        title: 'Total Sales by Product Monthly'
    })
    .draw();
```

### Viz type

You specify the viz type by calling the `as(vizType)` method on the visualization builder.

You need to provide the name of the viz type you want to use as a **string**.

| Name          | Reference                                             |
| ------------- | ----------------------------------------------------- |
| chart       | [Bar charts, Line charts etc.](#chart-visualizations) |
| text        | [Text](#text-viz)                                     |
| table       | [Table](#table-viz)                                   |
| guage       | [Gauge](#gauge-visualization)                         |

The viz type can also be the name of any registered [custom visualizations.](#custom-visualizations)

### Container

You specify the container by calling the `inside(container)` method on the visualization builder.

The container can either be a reference to a **HTMLElement** or the id of the HTML element as a **string**.

Your HTML element you provide as a container **must** have an explicit height for the visualization to display correctly.

### Options

You specify the options by calling the `with(options)` method on the visualization builder.

The options for a viz contains [field options](#field-options), [interval options](#interval-options) (if applicable)
and any specific options related to the viz type.  For example:

```js
{
    fields: { /* field options */ },
    intervals: { /* interval options */ },
    chart: { /* chart specific options */ },
    gauge: { /* gauge specific topions */ }
}
```
